# 贡献指南

<cite>
**本文档引用的文件**
- [GIT_PUSH_GUIDE.md](file://GIT_PUSH_GUIDE.md)
- [git_config.ini](file://git_config.ini)
- [quick_commit.sh](file://quick_commit.sh)
- [auto_push.bat](file://auto_push.bat)
- [README.md](file://README.md)
- [DATABASE_GUIDE.md](file://DATABASE_GUIDE.md)
- [package.json](file://package.json)
- [07-frontend/package.json](file://07-frontend/package.json)
</cite>

## 目录
1. [简介](#简介)
2. [代码提交规范](#代码提交规范)
3. [分支管理策略](#分支管理策略)
4. [Pull Request流程](#pull-request流程)
5. [自动化脚本使用](#自动化脚本使用)
6. [代码风格要求](#代码风格要求)
7. [本地开发环境搭建](#本地开发环境搭建)
8. [测试策略](#测试策略)
9. [问题报告与功能请求](#问题报告与功能请求)

## 简介

本贡献指南旨在为开发者提供清晰的参与项目开发的指导。文档基于GIT_PUSH_GUIDE.md和git_config.ini文件，详细说明了代码提交规范、分支管理策略、Pull Request流程以及自动化脚本的使用方法。通过遵循本指南，开发者可以高效地参与项目开发，确保代码质量和团队协作的顺畅。

**Section sources**
- [README.md](file://README.md#L1-L204)

## 代码提交规范

### 提交消息格式

提交消息应遵循语义化提交规范，格式如下：

```
<类型>: <描述> - <时间戳>
```

其中：
- **类型**：包括`feat`（新功能）、`fix`（修复bug）、`docs`（文档更新）、`style`（代码格式调整）、`refactor`（代码重构）、`test`（测试相关）、`chore`（构建过程或辅助工具的变动）
- **描述**：简明扼要地描述变更内容
- **时间戳**：自动生成的日期和时间

### 提交示例

```
feat: 添加项目管理、设计管理组件 - 2024-03-26 14:30
fix: 更新文档管理、版本控制 - 2024-03-26 16:20
docs: 更新贡献指南文档 - 2024-03-26 17:45
```

**Section sources**
- [GIT_PUSH_GUIDE.md](file://GIT_PUSH_GUIDE.md#L94-L99)

## 分支管理策略

### 当前分支

项目当前使用`feature_ai_laptop_1`作为主要开发分支。

### 分支命名规范

- **特性分支**：`feature/<功能名称>`，如`feature/project-management`
- **修复分支**：`fix/<问题描述>`，如`fix/login-bug`
- **发布分支**：`release/<版本号>`，如`release/v1.0.0`
- **热修复分支**：`hotfix/<问题描述>`，如`hotfix/security-patch`

### 分支管理流程

1. 从`feature_ai_laptop_1`分支创建新的特性分支
2. 在特性分支上进行开发
3. 完成开发后，创建Pull Request合并到`feature_ai_laptop_1`
4. 经过代码审查后，合并代码

**Section sources**
- [GIT_PUSH_GUIDE.md](file://GIT_PUSH_GUIDE.md#L64-L66)
- [README.md](file://README.md#L186-L190)

## Pull Request流程

### 创建Pull Request

1. 确保本地代码与远程仓库同步
2. 创建描述清晰的Pull Request
3. 在Pull Request中详细说明变更内容和目的
4. 指定相关代码审查人员

### Pull Request审查标准

- 代码是否符合项目风格规范
- 是否有足够的测试覆盖
- 是否解决了预期的问题
- 是否有潜在的性能问题
- 文档是否同步更新

### 合并条件

- 至少一名团队成员批准
- 所有自动化测试通过
- 代码风格检查通过
- 代码覆盖率达标

**Section sources**
- [README.md](file://README.md#L186-L190)

## 自动化脚本使用

### 推荐脚本

项目提供了三个Git自动推送脚本，推荐使用顺序如下：

#### 1. `quick_push.ps1` (PowerShell脚本) - ⭐ 推荐

- **功能最强**：智能分析文件变化，生成语义化提交信息
- **界面美观**：彩色输出，进度显示清晰
- **智能识别**：自动识别Vue组件并生成合适的提交信息
- **操作简单**：一键完成添加、提交、推送

```powershell
# 使用方法
./quick_push.ps1
# 或者右键 → 使用 PowerShell 运行
```

#### 2. `smart_commit.bat` (批处理脚本)

- **智能提交**：自动分析文件类型和变化
- **兼容性好**：所有Windows系统都可以运行
- **中文友好**：完全中文界面

```batch
# 使用方法
smart_commit.bat
# 或者双击运行
```

#### 3. `auto_push.bat` (简单批处理)

- **简单直接**：基础功能，适合快速操作
- **轻量级**：代码最少，运行最快

```batch
# 使用方法
auto_push.bat
```

### 使用场景推荐

| 场景 | 推荐脚本 | 原因 |
|------|----------|------|
| 日常Vue组件开发 | `quick_push.ps1` | 智能识别Vue文件，生成语义化提交信息 |
| 快速临时提交 | `auto_push.bat` | 简单快速，一键完成 |
| 需要详细控制 | `smart_commit.bat` | 提供更多选择和控制选项 |
| 团队协作 | `quick_push.ps1` | 生成规范的提交信息，便于团队协作 |

**Section sources**
- [GIT_PUSH_GUIDE.md](file://GIT_PUSH_GUIDE.md#L7-L61)

## 代码风格要求

### 代码格式化

项目使用ESLint和Prettier进行代码风格管理。

#### ESLint配置

- 语法检查
- 代码质量检查
- 最佳实践检查

#### Prettier配置

- 代码格式化
- 统一代码风格
- 自动修复格式问题

### 配置文件

项目根目录的`package.json`文件中包含了相关脚本：

```json
"scripts": {
  "lint": "eslint . --ext .vue,.js,.jsx,.cjs,.mjs,.ts,.tsx,.cts,.mts --fix --ignore-path .gitignore",
  "format": "prettier --write src/"
}
```

### 执行命令

```bash
# 运行代码检查
npm run lint

# 格式化代码
npm run format
```

**Section sources**
- [07-frontend/package.json](file://07-frontend/package.json#L9-L11)
- [package.json](file://package.json#L5-L8)

## 本地开发环境搭建

### 环境要求

- Node.js 16+
- npm 或 yarn
- HBuilderX（推荐，用于UniApp开发）

### 安装依赖

```bash
# PC端
cd 07-frontend
npm install
npm run dev

# 移动端
cd platforms/mobile
npm install
```

### 启动后端服务器

```bash
# 启动后端服务器
npm run backend

# 或在开发模式下运行（支持热重载）
npm run dev:backend
```

后端服务器将在 `http://localhost:3005` 启动。

### 启动前端应用

```bash
# 在 07-frontend 目录下运行
cd 07-frontend
npm run dev
```

前端应用将在 `http://localhost:3018` （或下一个可用端口）启动。

### 数据库初始化

项目使用SQLite数据库系统，数据持久化存储在本地文件中。

#### 数据存储位置

```
data/
├── enterprise_brain.db  (默认数据库)
├── production/
│   └── enterprise_brain.db  (生产环境数据库)
├── development/
│   └── enterprise_brain.db  (开发环境数据库)
└── testing/
    └── enterprise_brain.db  (测试环境数据库)
```

#### 环境配置

- **生产环境**: `NODE_ENV=production npm run backend`
- **开发环境**: `NODE_ENV=development npm run backend` (默认)
- **测试环境**: `NODE_ENV=testing npm run backend`

**Section sources**
- [README.md](file://README.md#L133-L155)
- [DATABASE_GUIDE.md](file://DATABASE_GUIDE.md#L23-L69)

## 测试策略

### 测试框架

项目使用Vue Test Utils进行单元测试。

### 测试文件结构

测试文件位于`src/tests/unit/`目录下，按照模块组织。

### 测试示例

```javascript
import { mount } from '@vue/test-utils';
import AuditLogList from '@/pages/system/audit-management/AuditLogList.vue';
import { ElTable } from 'element-plus';

describe('AuditLogList.vue', () => {
  it('renders table when data is loaded', async () => {
    const wrapper = mount(AuditLogList, {
      global: {
        stubs: { ElTable }
      }
    });
    
    // 模拟数据加载
    await wrapper.vm.fetchAuditLogs();
    expect(wrapper.findComponent(ElTable).exists()).toBe(true);
  });
});
```

### 测试覆盖率要求

- 核心业务逻辑：≥ 80%
- 通用组件：≥ 70%
- 辅助函数：≥ 60%

### 运行测试

```bash
# 运行所有测试
npm run test

# 运行特定模块测试
npm run test -- --grep "AuditLogList"
```

**Section sources**
- [07-frontend/src/tests/unit/modules/system/audit/AuditLogList.spec.js](file://07-frontend/src/tests/unit/modules/system/audit/AuditLogList.spec.js#L1-L18)

## 问题报告与功能请求

### 问题报告流程

1. 在GitHub Issues中搜索是否已有类似问题
2. 如果没有，创建新的Issue
3. 使用问题模板填写详细信息：
   - 问题描述
   - 复现步骤
   - 预期行为
   - 实际行为
   - 环境信息（操作系统、浏览器、版本等）
   - 错误日志或截图

### 功能请求流程

1. 在GitHub Discussions中搜索是否已有类似功能讨论
2. 如果没有，创建新的Discussion
3. 详细描述功能需求：
   - 功能目的
   - 使用场景
   - 预期效果
   - 相关截图或原型
   - 优先级建议

### 协作机制

- 定期查看Issues和Discussions
- 及时响应社区反馈
- 对重要问题进行标记和分类
- 定期发布更新日志

**Section sources**
- [README.md](file://README.md#L184-L190)