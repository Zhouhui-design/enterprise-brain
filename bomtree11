// 保存BOM树到后端
saveBomTreeToServer() {
  const bomData = {
    l0Node: this.l0Node,
    bomTreeData: this.bomTreeData,
    maxLevels: this.maxLevels,
    nodesPerParent: this.nodesPerParent
  };

  const bomTreeName = prompt('请输入BOM树名称：');
  if (!bomTreeName) return;

  fetch('http://localhost:3000/api/bom/save', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      name: bomTreeName,
      bomData: bomData
    })
  })
  .then(response => response.json())
  .then(data => {
    alert(`BOM树已保存，ID: ${data.id}`);
  })
  .catch(error => {
    console.error('Error:', error);
    alert('保存失败');
  });
},

// 从后端加载BOM树列表
loadBomTreeList() {
  fetch('http://localhost:3000/api/bom/list')
    .then(response => response.json())
    .then(data => {
      // 这里可以将列表显示出来供用户选择
      console.log(data);
      // 简单起见，我们假设用户选择第一个
      if (data.length > 0) {
        const confirmLoad = confirm(`是否加载BOM树: ${data[0].name}?`);
        if (confirmLoad) {
          this.loadBomTreeFromServer(data[0].id);
        }
      }
    })
    .catch(error => {
      console.error('Error:', error);
      alert('加载列表失败');
    });
},

// 根据ID从后端加载BOM树
loadBomTreeFromServer(id) {
  fetch(`http://localhost:3000/api/bom/${id}`)
    .then(response => response.json())
    .then(data => {
      this.l0Node = data.bom_data.l0Node;
      this.bomTreeData = data.bom_data.bomTreeData;
      this.maxLevels = data.bom_data.maxLevels;
      this.nodesPerParent = data.bom_data.nodesPerParent;

      this.updateLayout();
      alert('BOM树已加载');
    })
    .catch(error => {
      console.error('Error:', error);
      alert('加载BOM树失败');
    });
}