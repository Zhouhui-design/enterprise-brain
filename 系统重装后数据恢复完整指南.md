# ç³»ç»Ÿé‡è£…åæ•°æ®æ¢å¤å®Œæ•´æŒ‡å—

## ç´§æ€¥å¤‡ä»½æªæ–½

### 1. ç«‹å³æ¨é€å½“å‰ä»£ç åˆ°è¿œç¨‹
```bash
cd /home/sardensy/enterprise-brain/enterpise-brain
git add -A
git commit -m "ç´§æ€¥å¤‡ä»½ï¼šä¿®å¤ç¡®è®¤ä¸‹å•åŠŸèƒ½å’Œæ•°æ®åº“å­—æ®µç¼ºå¤±"
git push origin feature-3
```

### 2. ä»£ç æ¢å¤æµç¨‹ï¼ˆé‡è£…ç³»ç»Ÿåï¼‰

#### æ­¥éª¤1ï¼šå®‰è£…å¿…è¦ç¯å¢ƒ
```bash
# å®‰è£…Node.js (å»ºè®®18.xæˆ–20.x)
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# å®‰è£…MySQL
sudo apt update
sudo apt install mysql-server
sudo mysql_secure_installation

# å®‰è£…Git
sudo apt install git
```

#### æ­¥éª¤2ï¼šå…‹éš†ä»£ç ä»“åº“
```bash
# ä»è¿œç¨‹ä»“åº“å…‹éš†ä»£ç 
git clone https://gitcode.com/sardenesy/enterpise-brain.git
cd enterpise-brain
git checkout feature-3

# æˆ–è€…å¦‚æœå·²æœ‰æœ¬åœ°ä»£ç ï¼Œé‡æ–°å…³è”è¿œç¨‹ä»“åº“
git remote add origin https://gitcode.com/sardenesy/enterpise-brain.git
git fetch origin
git reset --hard origin/feature-3
```

#### æ­¥éª¤3ï¼šæ•°æ®åº“æ¢å¤
```bash
# ç™»å½•MySQLåˆ›å»ºæ•°æ®åº“
mysql -u root -p
CREATE DATABASE enterprise_brain CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
EXIT;

# æ¢å¤æ•°æ®åº“ç»“æ„ï¼ˆä»£ç ä¸­çš„åˆå§‹åŒ–è„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»ºè¡¨ï¼‰
cd backend
node init-db.js

# ğŸ”¥ é‡è¦ï¼šæ‰§è¡Œæ•°æ®åº“ä¿®å¤è„šæœ¬ï¼Œè§£å†³å­—æ®µç¼ºå¤±é—®é¢˜
mysql -u root -p enterprise_brain < database_fix.sql
cd backend
npm install
node server.js  # å¯åŠ¨æœåŠ¡ä¼šè‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“
```

## å·²ä¿®å¤çš„é—®é¢˜

### 1. é”€å”®è®¢å•åˆ›å»ºå¤±è´¥
**é—®é¢˜**ï¼š`Unknown column 'submitter' in 'field list'`
**ä¿®å¤**ï¼š
```sql
ALTER TABLE sales_orders ADD COLUMN submitter VARCHAR(100) DEFAULT 'admin' COMMENT 'æäº¤äºº' AFTER salesperson;
ALTER TABLE sales_order_products ADD COLUMN output_process VARCHAR(100) COMMENT 'äº§å‡ºå·¥åº' AFTER accessories;
```

### 2. ç¡®è®¤ä¸‹å•å¤±è´¥
**é—®é¢˜**ï¼š`Unknown column 'default_procurement_lead_time' in 'field list'`
**ä¿®å¤**ï¼š
```sql
ALTER TABLE materials ADD COLUMN default_procurement_lead_time INT DEFAULT 3 COMMENT 'é»˜è®¤é‡‡è´­æå‰æœŸï¼ˆå¤©ï¼‰' AFTER purchase_cycle;
ALTER TABLE procurement_plans ADD COLUMN procurement_lead_time INT DEFAULT 3 COMMENT 'é‡‡è´­æå‰æœŸï¼ˆå¤©ï¼‰' AFTER plan_arrival_date;
```

## æ•°æ®åº“å®Œæ•´æ€§ä¿®å¤è„šæœ¬

åˆ›å»ºå®Œæ•´çš„æ•°æ®åº“ä¿®å¤è„šæœ¬ï¼š
```sql
-- é”€å”®è®¢å•ç›¸å…³è¡¨ä¿®å¤
ALTER TABLE sales_orders ADD COLUMN IF NOT EXISTS submitter VARCHAR(100) DEFAULT 'admin' COMMENT 'æäº¤äºº' AFTER salesperson;
ALTER TABLE sales_order_products ADD COLUMN IF NOT EXISTS output_process VARCHAR(100) COMMENT 'äº§å‡ºå·¥åº' AFTER accessories;

-- ç‰©æ–™å’Œé‡‡è´­ç›¸å…³è¡¨ä¿®å¤
ALTER TABLE materials ADD COLUMN IF NOT EXISTS default_procurement_lead_time INT DEFAULT 3 COMMENT 'é»˜è®¤é‡‡è´­æå‰æœŸï¼ˆå¤©ï¼‰' AFTER purchase_cycle;
ALTER TABLE procurement_plans ADD COLUMN IF NOT EXISTS procurement_lead_time INT DEFAULT 3 COMMENT 'é‡‡è´­æå‰æœŸï¼ˆå¤©ï¼‰' AFTER plan_arrival_date;

-- ç¡®ä¿å¿…è¦ç´¢å¼•å­˜åœ¨
CREATE INDEX IF NOT EXISTS idx_sales_orders_status ON sales_orders(status);
CREATE INDEX IF NOT EXISTS idx_sales_order_products_order_id ON sales_order_products(order_id);
CREATE INDEX IF NOT EXISTS idx_materials_material_code ON materials(material_code);
CREATE INDEX IF NOT EXISTS idx_procurement_plans_source_no ON procurement_plans(source_no);
```

## ç³»ç»Ÿé‡è£…åæ£€æŸ¥æ¸…å•

### 1. ç¯å¢ƒæ£€æŸ¥
- [ ] Node.js 18+ å·²å®‰è£…
- [ ] MySQL 8.0+ å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] Git å·²é…ç½®
- [ ] ç«¯å£3003ã€3005ã€3306å¯ç”¨

### 2. ä»£ç æ£€æŸ¥
- [ ] ä»£ç ä»è¿œç¨‹ä»“åº“æˆåŠŸæ‹‰å–
- [ ] npmä¾èµ–å·²å®‰è£…
- [ ] é…ç½®æ–‡ä»¶æ­£ç¡®ï¼ˆæ•°æ®åº“è¿æ¥ç­‰ï¼‰

### 3. æ•°æ®åº“æ£€æŸ¥
- [ ] æ•°æ®åº“enterprise_brainå·²åˆ›å»º
- [ ] æ‰€æœ‰è¡¨ç»“æ„å®Œæ•´
- [ ] å¿…è¦å­—æ®µå·²æ·»åŠ 
- [ ] ç´¢å¼•å·²åˆ›å»º

### 4. åŠŸèƒ½æµ‹è¯•
- [ ] é”€å”®è®¢å•åˆ—è¡¨é¡µé¢æ­£å¸¸
- [ ] æ–°å¢é”€å”®è®¢å•åŠŸèƒ½æ­£å¸¸
- [ ] ç¡®è®¤ä¸‹å•åŠŸèƒ½æ­£å¸¸
- [ ] ä¸»ç”Ÿäº§è®¡åˆ’æ¨é€æ­£å¸¸
- [ ] é‡‡è´­è®¡åˆ’æ¨é€æ­£å¸¸

## å¤‡ä»½ç­–ç•¥å»ºè®®

### 1. ä»£ç å¤‡ä»½
```bash
# æ¯æ—¥è‡ªåŠ¨æ¨é€è„šæœ¬
#!/bin/bash
cd /path/to/project
git add -A
git commit -m "è‡ªåŠ¨å¤‡ä»½ $(date +'%Y-%m-%d %H:%M:%S')"
git push origin feature-3
```

### 2. æ•°æ®åº“å¤‡ä»½
```bash
# æ¯æ—¥æ•°æ®åº“å¤‡ä»½è„šæœ¬
#!/bin/bash
mysqldump -u root -p enterprise_brain > /backup/enterprise_brain_$(date +%Y%m%d).sql
```

### 3. å®Œæ•´æ¢å¤è„šæœ¬
```bash
#!/bin/bash
# å®Œæ•´ç³»ç»Ÿæ¢å¤è„šæœ¬
echo "å¼€å§‹æ¢å¤ä¼ä¸šå¤§è„‘ç³»ç»Ÿ..."

# 1. æ¢å¤ä»£ç 
git clone https://gitcode.com/sardenesy/enterpise-brain.git
cd enterpise-brain
git checkout feature-3

# 2. æ¢å¤æ•°æ®åº“
mysql -u root -p -e "CREATE DATABASE IF NOT EXISTS enterprise_brain"
mysql -u root -p enterprise_brain < /backup/enterprise_brain_latest.sql

# 3. å®‰è£…ä¾èµ–å¹¶å¯åŠ¨
npm install
npm run dev

echo "ç³»ç»Ÿæ¢å¤å®Œæˆï¼"
```

## ç´§æ€¥è”ç³»æ–¹å¼
- è¿œç¨‹ä»“åº“ï¼šhttps://gitcode.com/sardenesy/enterpise-brain/tree/feature-3
- æœ¬åœ°æœåŠ¡ï¼šhttp://localhost:3003
- æ•°æ®åº“ï¼šlocalhost:3306/enterprise_brain

## é‡è¦æé†’
1. **å®šæœŸæ¨é€**ï¼šæ¯å¤©ç»“æŸå·¥ä½œå‰åŠ¡å¿…æ¨é€ä»£ç åˆ°è¿œç¨‹
2. **æ•°æ®åº“å¤‡ä»½**ï¼šæ¯å‘¨è‡³å°‘å¤‡ä»½ä¸€æ¬¡æ•°æ®åº“
3. **æ–‡æ¡£åŒæ­¥**ï¼šé‡è¦ä¿®æ”¹è¦åŒæ­¥æ›´æ–°æ–‡æ¡£
4. **æµ‹è¯•éªŒè¯**ï¼šé‡è£…ç³»ç»Ÿåè¦å…¨é¢æµ‹è¯•æ‰€æœ‰åŠŸèƒ½

---

**æœ€åæ›´æ–°æ—¶é—´**ï¼š2025-12-18
**ä¿®å¤å†…å®¹**ï¼šé”€å”®è®¢å•åˆ›å»ºã€ç¡®è®¤ä¸‹å•åŠŸèƒ½ã€æ•°æ®åº“å­—æ®µç¼ºå¤±