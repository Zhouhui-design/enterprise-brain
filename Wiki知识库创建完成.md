# Wiki知识库已创建完成

## ✅ 已完成的工作

### 1. Wiki目录结构
```
wiki/
├── README.md                               # Wiki主页和使用指南
├── 01-数据流规则/
│   └── 03-真工序计划计算规则.md            # 完整的计算规则文档
├── 02-字段映射关系/
│   └── 01-真工序计划字段映射.md            # 页面字段与数据库字段映射
├── 03-调试指南/
│   ├── 01-真工序计划调试指南.md            # 完整的问题排查流程
│   ├── 02-使用浏览器断点调试.md            # 浏览器调试教程
│   └── 03-Quest任务管理指南.md             # Quest使用指南
└── 04-常见问题/
    └── 01-计划日期未按规则生成.md          # 当前问题的诊断方案
```

### 2. 文档内容概要

#### 📋 真工序计划计算规则 (`01-数据流规则/03-真工序计划计算规则.md`)
- **业务背景**：数据流向和触发时机
- **计划结束日期规则**：MAXIFS反向查询逻辑
- **计划开始日期规则**：反向累加追溯逻辑
- **特殊规则**：需求工时为0、找不到日期等边界情况
- **示例演示**：详细的计算过程示例
- **相关文件**：前端、后端、数据库文件清单

#### 🗺️ 真工序计划字段映射 (`02-字段映射关系/01-真工序计划字段映射.md`)
- **完整字段映射表**：页面显示字段 ↔ 数据库字段
- **关键计算字段详解**：
  - 需求工时（requiredWorkHours）
  - 计划结束日期（planEndDate）
  - 计划开始日期（planStartDate）
- **数据来源追溯**：字段来源和传递路径
- **调试技巧**：查看前端、API、数据库的方法

#### 🔍 真工序计划调试指南 (`03-调试指南/01-真工序计划调试指南.md`)
- **完整排查流程**：8个步骤的详细排查方法
  1. 确认业务规则
  2. 使用浏览器开发者工具
  3. 使用浏览器断点调试（重要）
  4. 检查后端日志
  5. 检查工序能力负荷表数据
  6. 检查业务变量配置
  7. 常见问题排查
  8. 使用Quest创建调试任务
- **诊断脚本**：可直接粘贴到浏览器Console运行
- **预期日志输出示例**：帮助判断正常/异常状态

#### 💻 使用浏览器断点调试 (`03-调试指南/02-使用浏览器断点调试.md`)
- **基础操作**：打开开发者工具、设置断点、单步执行
- **实战案例**：调试真工序计划开始日期问题
  - 设置关键断点的位置
  - 检查变量值的方法
  - 单步执行流程
  - 查看调用栈
- **进阶技巧**：
  - 监视表达式（Watch）
  - 异步代码调试
  - 网络请求调试
  - 使用logpoints
  - 黑盒脚本
- **调试实战练习**：验证计算逻辑、检查数据一致性
- **快速参考卡**：快捷键速查表

#### 📝 Quest任务管理指南 (`03-调试指南/03-Quest任务管理指南.md`)
- **基础操作**：创建任务、管理状态、添加详情
- **实战案例**：
  - BUG排查任务模板
  - 功能开发任务模板
  - 技术笔记任务模板
- **任务组织策略**：标签分类、优先级管理、任务分组
- **高级技巧**：任务模板、关联Wiki、任务依赖、时间追踪
- **工作流程**：日常开发流程、BUG修复流程
- **最佳实践**：任务命名、状态更新、过程记录

#### ❓ 常见问题：计划日期未按规则生成 (`04-常见问题/01-计划日期未按规则生成.md`)
- **问题分类**：
  - 问题1：计划开始日期为null（4个原因+解决方案）
  - 问题2：计划结束日期为null（3个原因+解决方案）
  - 问题3：计划开始日期晚于计划结束日期（2个原因+解决方案）
- **诊断流程图**：Mermaid流程图可视化排查路径
- **快速检查清单**：前端、后端、数据检查
- **自助诊断脚本**：浏览器Console诊断工具
- **BUG报告模板**：标准化的问题提交格式

## 🎯 如何使用Wiki

### 1. 当遇到BUG时
```
1. 打开 wiki/README.md 查看总体结构
2. 进入 04-常见问题/ 查看是否有类似问题
3. 如果没有，查看 01-数据流规则/ 确认业务规则
4. 使用 03-调试指南/ 按步骤排查
5. 排查完成后，更新 04-常见问题/ 记录解决方案
```

### 2. 开发新功能时
```
1. 在 01-数据流规则/ 记录业务规则
2. 在 02-字段映射关系/ 记录字段映射
3. 实现功能
4. 更新 03-调试指南/ 添加调试技巧（如需要）
```

### 3. 学习系统时
```
1. 阅读 01-数据流规则/ 理解业务逻辑
2. 阅读 02-字段映射关系/ 了解数据结构
3. 阅读 03-调试指南/ 掌握调试方法
4. 使用 Quest 记录学习笔记
```

## 📊 当前问题诊断

### 问题描述
- **问题**：计划开始日期未按规则生成
- **预期结果**：计划开始日期 = 2025-12-31
- **实际结果**：计划开始日期未生成

### 下一步行动

1. **打开真工序计划页面**：
   ```
   http://localhost:3007/process-planning/real-process-plan
   ```

2. **打开浏览器开发者工具**（F12）

3. **运行诊断脚本**（复制到Console）：
   ```javascript
   // 诊断脚本见 wiki/04-常见问题/01-计划日期未按规则生成.md
   ```

4. **查看后端日志**：
   ```bash
   tail -f ~/ai_workspaces/ai_desktop_3/backend.log
   ```

5. **检查工序能力负荷表**：
   ```sql
   SELECT process_name, date, remaining_hours
   FROM process_capacity_load
   WHERE process_name = '您的工序名称'
     AND date BETWEEN '2025-12-01' AND '2026-01-06'
   ORDER BY date DESC;
   ```

6. **按照调试指南排查**：
   参见 `wiki/03-调试指南/01-真工序计划调试指南.md`

## 🔧 工具和脚本

### 浏览器诊断脚本
位置：`wiki/04-常见问题/01-计划日期未按规则生成.md` 中的"自助诊断脚本"

### 数据库诊断脚本
已创建：`check_plan_start_date_issue.js`（但需要正确的数据库密码）

## 📚 推荐阅读顺序

### 第一次使用Wiki
1. `wiki/README.md` - 了解Wiki结构
2. `wiki/03-调试指南/02-使用浏览器断点调试.md` - 学习调试技巧
3. `wiki/03-调试指南/03-Quest任务管理指南.md` - 学习Quest使用

### 排查当前问题
1. `wiki/01-数据流规则/03-真工序计划计算规则.md` - 确认业务规则
2. `wiki/02-字段映射关系/01-真工序计划字段映射.md` - 确认字段对应
3. `wiki/03-调试指南/01-真工序计划调试指南.md` - 按步骤排查
4. `wiki/04-常见问题/01-计划日期未按规则生成.md` - 查看诊断方案

## 💡 下一步建议

1. **立即行动**：
   - 打开真工序计划页面
   - 按F12打开开发者工具
   - 运行诊断脚本
   - 查看Console输出

2. **使用Quest管理**：
   - 在QODER IDE左侧点击Quest
   - 创建任务："调试真工序计划开始日期问题"
   - 记录每一步的发现

3. **持续完善Wiki**：
   - 问题解决后，更新常见问题文档
   - 发现新的数据流规则时，及时记录
   - 学到调试技巧时，更新调试指南

## 📞 需要帮助？

如果遇到以下情况：
- 诊断脚本无法运行
- 看不懂日志输出
- 不确定如何设置断点
- 其他技术问题

请参考对应的Wiki文档，或创建Quest任务记录问题，寻求协助。

---

**Wiki创建完成时间**：2025-12-11  
**Wiki位置**：`/home/sardenesy/ai_workspaces/ai_desktop_3/wiki/`  
**维护者**：开发团队

## 🎉 总结

您现在拥有了：
✅ 完整的Wiki知识库系统
✅ 详细的调试指南和工具
✅ Quest任务管理方法
✅ 浏览器断点调试技能
✅ 问题诊断的标准流程

这些工具和文档将帮助您：
- 快速定位和解决BUG
- 理解系统的业务规则
- 提高开发效率
- 建立知识沉淀体系

**开始使用Wiki，让每一个问题都成为经验的积累！** 🚀
