<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥åºé—´éš”è®¾ç½®é¡µé¢éªŒè¯æŠ¥å‘Š</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .success { color: #67C23A; }
        .error { color: #F56C6C; }
        .warning { color: #E6A23C; }
        .info { color: #409EFF; }
        .code { background: #f5f5f5; padding: 10px; border-radius: 4px; margin: 10px 0; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #e4e7ed; border-radius: 8px; }
        h1, h2, h3 { color: #303133; }
        ul li { margin: 5px 0; }
        .check-item { padding: 8px; margin: 5px 0; border-radius: 4px; }
        .check-pass { background: #f0f9ff; border-left: 4px solid #67C23A; }
        .check-fail { background: #fef0f0; border-left: 4px solid #F56C6C; }
    </style>
</head>
<body>
    <h1>ğŸ”§ å·¥åºé—´éš”è®¾ç½®é¡µé¢ä¿®å¤å®ŒæˆéªŒè¯æŠ¥å‘Š</h1>
    
    <div class="section">
        <h2 class="info">ğŸ“‹ ä¿®å¤å†…å®¹æ€»è§ˆ</h2>
        <ol>
            <li><strong>ä¿®å¤å·¥åºåˆ—è¡¨æ•°æ®æº</strong>ï¼šä»localStorageæ”¹ä¸ºåç«¯APIåŠ è½½</li>
            <li><strong>ä¿®å¤APIå“åº”å­—æ®µ</strong>ï¼šä»recordsæ”¹ä¸ºdataå­—æ®µ</li>
            <li><strong>æ·»åŠ é»˜è®¤æ•°æ®åˆå§‹åŒ–</strong>ï¼šlocalStorageä¸ºç©ºæ—¶åˆ›å»ºç¤ºä¾‹æ•°æ®</li>
            <li><strong>ä¼˜åŒ–åŠ è½½æ—¶åº</strong>ï¼šå…ˆåŠ è½½å·¥åºåˆ—è¡¨å†åŠ è½½æ•°æ®</li>
            <li><strong>å¢å¼ºé”™è¯¯å¤„ç†</strong>ï¼šæ·»åŠ ç½‘ç»œé”™è¯¯å’Œæ•°æ®éªŒè¯</li>
        </ol>
    </div>

    <div class="section">
        <h2 class="success">âœ… éªŒè¯ç»“æœ</h2>
        
        <h3>1. APIè¿æ¥éªŒè¯</h3>
        <div class="check-item check-pass">
            <strong>âœ… åç«¯APIè¿æ¥æ­£å¸¸</strong><br>
            åœ°å€ï¼šhttp://192.168.2.229:3005/api/processes/list<br>
            çŠ¶æ€ï¼šè¿”å›37ä¸ªå·¥åºæ•°æ®
        </div>

        <h3>2. å‰ç«¯æœåŠ¡éªŒè¯</h3>
        <div class="check-item check-pass">
            <strong>âœ… å‰ç«¯æœåŠ¡è¿è¡Œæ­£å¸¸</strong><br>
            åœ°å€ï¼šhttp://localhost:3003<br>
            çŠ¶æ€ï¼šViteå¼€å‘æœåŠ¡å™¨æ­£å¸¸å“åº”
        </div>

        <h3>3. ä»£ç ä¿®å¤éªŒè¯</h3>
        <div class="check-item check-pass">
            <strong>âœ… loadProcessListå‡½æ•°å·²ä¿®å¤</strong><br>
            - æ­£ç¡®è°ƒç”¨åç«¯API<br>
            - ä½¿ç”¨result.dataè·å–æ•°æ®<br>
            - æ·»åŠ é”™è¯¯å¤„ç†å’Œæ—¥å¿—
        </div>

        <div class="check-item check-pass">
            <strong>âœ… é»˜è®¤æ•°æ®åˆå§‹åŒ–å·²å®ç°</strong><br>
            - localStorageä¸ºç©ºæ—¶è‡ªåŠ¨åˆ›å»º5æ¡ç¤ºä¾‹æ•°æ®<br>
            - åªåˆ›å»ºå­˜åœ¨äºå·¥åºåˆ—è¡¨ä¸­çš„é—´éš”<br>
            - è‡ªåŠ¨ä¿å­˜åˆ°localStorage
        </div>

        <div class="check-item check-pass">
            <strong>âœ… è¡¨å•éªŒè¯å·²å®Œå–„</strong><br>
            - é˜²é‡å¤éªŒè¯é€»è¾‘æ­£ç¡®<br>
            - ç¼–è¾‘æ—¶æ’é™¤è‡ªèº«éªŒè¯<br>
            - ä¸‹æ‹‰æ¡†æ•°æ®ç»‘å®šæ­£ç¡®
        </div>
    </div>

    <div class="section">
        <h2 class="info">ğŸ” å…³é”®ä¿®å¤ä»£ç </h2>
        
        <h3>1. APIæ•°æ®æºä¿®å¤</h3>
        <div class="code">
<pre><code>// ä¿®å¤åçš„loadProcessListå‡½æ•°
const loadProcessList = async () => {
  try {
    console.log('ğŸ” å¼€å§‹åŠ è½½å·¥åºåˆ—è¡¨...')
    
    // ä»åç«¯APIåŠ è½½å·¥åºåˆ—è¡¨æ•°æ®
    const response = await fetch('http://192.168.2.229:3005/api/processes/list')
    const result = await response.json()
    
    if (result.code === 200 && result.data) {
      const allProcesses = result.data
      console.log('ğŸ“Š ä»åç«¯è·å–çš„å·¥åºæ•°æ®:', allProcesses)
      
      // åªéœ€è¦å·¥åºåç§°å­—æ®µï¼Œè¿‡æ»¤æ‰ç©ºå€¼
      processList.value = allProcesses
        .filter(p => p.process_name && p.process_name.trim())
        .map(p => ({
          label: p.process_name,
          value: p.process_name
        }))
      
      console.log(`âœ… åŠ è½½å·¥åºåˆ—è¡¨æˆåŠŸï¼Œå…± ${processList.value.length} æ¡æ•°æ®`)
    }
  } catch (error) {
    console.error('âŒ åŠ è½½å·¥åºåˆ—è¡¨å¤±è´¥:', error)
    ElMessage.error('åŠ è½½å·¥åºåˆ—è¡¨å¤±è´¥: ' + (error.message || 'ç½‘ç»œé”™è¯¯'))
  }
}</code></pre>
        </div>

        <h3>2. é»˜è®¤æ•°æ®åˆå§‹åŒ–</h3>
        <div class="code">
<pre><code>// localStorageä¸ºç©ºæ—¶çš„é»˜è®¤æ•°æ®å¤„ç†
if (!savedData && processList.value.length > 0) {
  const commonIntervals = [
    { previous: 'æ¿€å…‰ä¸‹æ–™', next: 'å†²åºŠ', unit: 'å°æ—¶', value: 2, remark: 'ä¸‹æ–™åå†²å‹é—´éš”' },
    { previous: 'å†²åºŠ', next: 'æŠ˜å¼¯', unit: 'å°æ—¶', value: 1, remark: 'å†²å‹åæŠ˜å¼¯é—´éš”' },
    { previous: 'æŠ˜å¼¯', next: 'ç„Šæ¥', unit: 'å°æ—¶', value: 3, remark: 'æŠ˜å¼¯åç„Šæ¥é—´éš”' },
    { previous: 'äººå·¥ç„Šæ¥', next: 'æœºå™¨æ‰“ç£¨', unit: 'å°æ—¶', value: 4, remark: 'ç„Šæ¥åæ‰“ç£¨é—´éš”' },
    { previous: 'æœºå™¨æ‰“ç£¨', next: 'å–·å¡‘', unit: 'å°æ—¶', value: 2, remark: 'æ‰“ç£¨åå–·å¡‘é—´éš”' }
  ]
  
  // åªåˆ›å»ºå­˜åœ¨äºå·¥åºåˆ—è¡¨ä¸­çš„é—´éš”
  commonIntervals.forEach((interval, index) => {
    const previousExists = processList.value.some(p => p.value === interval.previous)
    const nextExists = processList.value.some(p => p.value === interval.next)
    
    if (previousExists && nextExists) {
      defaultData.push({
        id: index + 1,
        previousProcess: interval.previous,
        nextProcess: interval.next,
        intervalUnit: interval.unit,
        intervalValue: interval.value,
        remark: interval.remark,
        createdAt: new Date().toISOString()
      })
    }
  })
  
  localStorage.setItem('processIntervalData', JSON.stringify(defaultData))
}</code></pre>
        </div>
    </div>

    <div class="section">
        <h2 class="info">ğŸ§ª æµ‹è¯•æ­¥éª¤</h2>
        <ol>
            <li><strong>è®¿é—®é¡µé¢</strong>ï¼š<a href="http://localhost:3003/manufacturing/process-interval-settings" target="_blank">å·¥åºé—´éš”è®¾ç½®é¡µé¢</a></li>
            <li><strong>å¼ºåˆ·æ–°</strong>ï¼šæŒ‰ Ctrl+F5 æ¸…é™¤ç¼“å­˜å¹¶åˆ·æ–°</li>
            <li><strong>æ£€æŸ¥æ§åˆ¶å°</strong>ï¼šæŸ¥çœ‹æ˜¯å¦è¿˜æœ‰"è¯·å…ˆåœ¨å·¥åºåˆ—è¡¨ä¸­æ·»åŠ å·¥åºæ•°æ®"é”™è¯¯</li>
            <li><strong>éªŒè¯ä¸‹æ‹‰æ¡†</strong>ï¼šç‚¹å‡»"æ–°å¢"æŒ‰é’®ï¼Œæ£€æŸ¥å·¥åºä¸‹æ‹‰æ¡†æ˜¯å¦æœ‰37ä¸ªé€‰é¡¹</li>
            <li><strong>æµ‹è¯•æ–°å¢</strong>ï¼šåˆ›å»ºä¸€æ¡æ–°çš„å·¥åºé—´éš”è®°å½•</li>
            <li><strong>æµ‹è¯•é˜²é‡å¤</strong>ï¼šå°è¯•åˆ›å»ºé‡å¤çš„å·¥åºé—´éš”ç»„åˆ</li>
            <li><strong>éªŒè¯é»˜è®¤æ•°æ®</strong>ï¼šæ¸…é™¤localStorageååˆ·æ–°ï¼Œæ£€æŸ¥æ˜¯å¦è‡ªåŠ¨åˆ›å»ºé»˜è®¤æ•°æ®</li>
        </ol>
    </div>

    <div class="section">
        <h2 class="warning">âš ï¸ æ³¨æ„äº‹é¡¹</h2>
        <ul>
            <li><strong>ç½‘ç»œä¾èµ–</strong>ï¼šé¡µé¢éœ€è¦èƒ½è®¿é—®åˆ°192.168.2.229:3005çš„åç«¯æœåŠ¡</li>
            <li><strong>æ•°æ®æŒä¹…åŒ–</strong>ï¼šå½“å‰ä½¿ç”¨localStorageå­˜å‚¨ï¼Œæ¸…é™¤æµè§ˆå™¨æ•°æ®ä¼šä¸¢å¤±</li>
            <li><strong>é»˜è®¤æ•°æ®</strong>ï¼šåªæœ‰å½“å·¥åºå­˜åœ¨äºåç«¯æ—¶æ‰ä¼šåˆ›å»ºå¯¹åº”çš„é»˜è®¤é—´éš”</li>
            <li><strong>Vueè­¦å‘Š</strong>ï¼šTransitionè­¦å‘Šå·²è§£å†³ï¼Œç°åœ¨åº”è¯¥ä¸å†å‡ºç°</li>
        </ul>
    </div>

    <div class="section">
        <h2 class="success">ğŸ‰ ä¿®å¤å®ŒæˆçŠ¶æ€</h2>
        <div class="check-item check-pass">
            <strong>âœ… æ‰€æœ‰å·²çŸ¥é—®é¢˜å·²ä¿®å¤</strong><br>
            - å·¥åºåˆ—è¡¨æ•°æ®æºä¿®å¤å®Œæˆ<br>
            - APIå“åº”å­—æ®µä¿®å¤å®Œæˆ<br>
            - é»˜è®¤æ•°æ®åˆå§‹åŒ–å®Œæˆ<br>
            - é¡µé¢åŠ è½½æ—¶åºä¼˜åŒ–å®Œæˆ<br>
            - é”™è¯¯å¤„ç†å¢å¼ºå®Œæˆ
        </div>
        
        <p class="success"><strong>é¡µé¢ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œä¸å†å‡ºç°"è¯·å…ˆåœ¨å·¥åºåˆ—è¡¨ä¸­æ·»åŠ å·¥åºæ•°æ®"çš„é”™è¯¯æç¤ºã€‚</strong></p>
    </div>

    <script>
        // è‡ªåŠ¨éªŒè¯APIè¿æ¥
        async function verifyAPI() {
            try {
                const response = await fetch('http://192.168.2.229:3005/api/processes/list')
                const result = await response.json()
                
                if (result.code === 200 && result.data) {
                    console.log('âœ… APIéªŒè¯æˆåŠŸ:', result.data.length, 'ä¸ªå·¥åº')
                    document.getElementById('api-status').innerHTML = 
                        '<span class="success">âœ… APIè¿æ¥æ­£å¸¸ï¼Œè¿”å›' + result.data.length + 'ä¸ªå·¥åºæ•°æ®</span>'
                } else {
                    throw new Error('APIå“åº”æ ¼å¼é”™è¯¯')
                }
            } catch (error) {
                console.error('âŒ APIéªŒè¯å¤±è´¥:', error)
                document.getElementById('api-status').innerHTML = 
                    '<span class="error">âŒ APIè¿æ¥å¤±è´¥: ' + error.message + '</span>'
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨éªŒè¯
        window.onload = function() {
            verifyAPI()
            
            // æ·»åŠ å®æ—¶æ—¶é—´æ˜¾ç¤º
            setInterval(function() {
                const now = new Date()
                document.getElementById('current-time').textContent = 
                    now.toLocaleString('zh-CN')
            }, 1000)
        }
    </script>

    <div class="section">
        <p><strong>éªŒè¯æ—¶é—´ï¼š</strong><span id="current-time"></span></p>
        <p><strong>APIçŠ¶æ€ï¼š</strong><span id="api-status">æ£€æµ‹ä¸­...</span></p>
    </div>
</body>
</html>