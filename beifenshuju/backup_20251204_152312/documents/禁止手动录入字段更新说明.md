# 禁止手动录入字段更新说明

## 📅 更新时间
2025年12月2日

---

## ✅ 更新内容

### 禁止手动录入的字段

为了保证数据一致性和可追溯性，以下字段已改为**只读显示**，禁止手动录入：

#### 1. 产出工序 ❌ 不能手动输入
- **显示方式：** 只读文本
- **数据来源：** 从物料库自动加载（`processName`字段）
- **触发时机：** 选择子件编码/名称时自动填充

#### 2. 子件来源 ❌ 不能手动选择
- **显示方式：** 只读文本
- **数据来源：** 从物料库自动加载（`source[0]`字段）
- **触发时机：** 选择子件编码/名称时自动填充

#### 3. 工序工资 ❌ 不能直接输入
- **显示方式：** 只读数字（保留2位小数）
- **数据来源：** 从物料库自动加载（`processPrice`字段）
- **触发时机：** 
  - 选择子件编码/名称时自动填充（自动模式）
  - 点击"加载工序工资"按钮（手动模式）

#### 4. 材料损耗 ❌ 不能手动输入
- **显示方式：** 只读数字（保留2位小数 + %）
- **数据来源：** 从物料库自动加载
- **触发时机：** 选择子件编码/名称时自动填充

#### 5. 材料单价 ❌ 不能直接输入
- **显示方式：** 只读数字（保留2位小数）
- **数据来源：** 从物料库自动加载（`purchasePrice`字段）
- **触发时机：** 
  - 选择子件编码/名称时自动填充（自动模式）
  - 点击"加载材料单价"按钮（手动模式）

---

## 🎯 修改前后对比

### 修改前
```
产出工序: [输入框可编辑]
子件来源: [下拉框可选择: 自制/客供/外购/外协]
工序工资: [数字输入框可编辑]
材料损耗: [数字输入框可编辑]
材料单价: [数字输入框可编辑]
```

### 修改后
```
产出工序: 冲压工序（只读）
子件来源: 外购（只读）
工序工资: 5.00（只读）
材料损耗: 3.50%（只读）
材料单价: 10.50（只读）
```

---

## 📊 显示规则

### 空值显示
如果字段为空或未加载，显示 `'-'`

### 数值格式
- **工序工资：** `0.00`（2位小数）
- **材料损耗：** `0.00%`（2位小数 + 百分号）
- **材料单价：** `0.00`（2位小数）

---

## 🔄 数据加载方式

### 自动模式
选择子件编码/名称后，这些字段会**自动填充**

### 手动模式
1. 选择子件编码/名称后，字段会自动填充基础数据
2. 如需更新，点击对应的加载按钮：
   - "加载工序工资" - 批量更新所有子件的工序工资
   - "加载材料单价" - 批量更新所有子件的材料单价

---

## ⚠️ 重要说明

### 为什么禁止手动录入？

1. **数据一致性** - 确保所有数据都来自物料库，避免数据不一致
2. **避免人工错误** - 杜绝手动输入导致的错误数据
3. **可追溯性** - 所有数据都有明确的来源，便于追溯和审计
4. **统一管理** - 从源头（物料库）控制数据质量

### 如果需要修改这些字段的值怎么办？

**正确做法：**
1. 到**物料管理**页面
2. 找到对应的物料
3. 修改物料的对应字段（产出工序、来源、工序单价、采购单价等）
4. 保存物料信息
5. 回到BOM页面，重新选择子件或点击加载按钮，数据会自动更新

**错误做法：** ❌
- 直接在BOM页面手动输入（已禁止）

---

## 📋 操作示例

### 示例1：添加新子件

1. 点击"添加子件"
2. 选择子件编码：`M001-螺丝A`
3. 系统自动填充：
   - 子件名称：`螺丝A`
   - 产出工序：`冲压工序`（只读）
   - 子件来源：`外购`（只读）
   - 工序工资：`5.00`（只读）
   - 材料损耗：`3.50%`（只读）
   - 材料单价：`0.50`（只读）
4. 手动填写：
   - 层阶：`1`
   - 标准用量：`10`
5. 保存

### 示例2：批量加载数据（手动模式）

1. 添加多个子件
2. 选择子件编码后，部分字段自动填充
3. 点击"加载工序工资"按钮 → 批量更新所有子件的工序工资
4. 点击"加载材料单价"按钮 → 批量更新所有子件的材料单价
5. 所有字段均为只读显示

---

## 🛡️ 规则保护

此更改已记录在：
- **规则文档：** `docs/BOM_CALCULATION_RULES.md`
- **修改记录：** 2025-12-02 - 禁止手动录入

**未经用户明确要求，不得恢复这些字段的手动输入功能！**

---

## 📞 技术支持

如有疑问，请查看：
- **规则文档：** `docs/BOM_CALCULATION_RULES.md`
- **使用指南：** `生产BOM手动加载功能使用指南.md`
- **完成报告：** `业务规则保护与性能优化完成报告.md`
