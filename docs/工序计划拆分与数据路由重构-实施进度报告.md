# å·¥åºè®¡åˆ’æ‹†åˆ†ä¸æ•°æ®è·¯ç”±é‡æ„ - å®æ–½è¿›åº¦æŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**: 2025-12-14  
**ä»»åŠ¡çŠ¶æ€**: è¿›è¡Œä¸­ (50%å®Œæˆ)

---

## ğŸ“‹ éœ€æ±‚å›é¡¾

### ç”¨æˆ·éœ€æ±‚
1. **å¤‡ä»½ä»£ç ** âœ… å·²å®Œæˆ
2. **é‡å‘½å**: åŒ…è£…å·¥åºè®¡åˆ’ â†’ æ‰“åŒ…å·¥åºè®¡åˆ’ â³ å¾…å®Œæˆ
3. **åˆ›å»ºæ•°æ®åº“è¡¨** âœ… å·²å®Œæˆ
   - `packing_process_plans` (æ‰“åŒ…å·¥åºè®¡åˆ’è¡¨)
   - `assembly_process_plans` (ç»„è£…å·¥åºè®¡åˆ’è¡¨)
4. **æ•°æ®æ¨é€è·¯ç”±** â³ å¾…å®Œæˆ
   - å¤‡æ–™è®¡åˆ’ä¸­ `ç‰©æ–™æ¥æº = "è‡ªåˆ¶"` ä¸” `æ¥æºå·¥åº = "æ‰“åŒ…"` â†’ æ¨é€åˆ°æ‰“åŒ…å·¥åºè®¡åˆ’è¡¨
   - å¤‡æ–™è®¡åˆ’ä¸­ `ç‰©æ–™æ¥æº = "è‡ªåˆ¶"` ä¸” `æ¥æºå·¥åº = "ç»„è£…"` â†’ æ¨é€åˆ°ç»„è£…å·¥åºè®¡åˆ’è¡¨

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. ä»£ç å¤‡ä»½
- GitçŠ¶æ€: å·¥ä½œåŒºå¹²å‡€,å·²ä¸è¿œç¨‹åŒæ­¥
- æäº¤è®°å½•: `3265b33` (èœå•é…ç½®ä¿®å¤æŠ¥å‘Š)

### 2. æ•°æ®åº“è¡¨åˆ›å»º

#### æ‰“åŒ…å·¥åºè®¡åˆ’è¡¨ (`packing_process_plans`)
```sql
CREATE TABLE IF NOT EXISTS packing_process_plans (
  id INT AUTO_INCREMENT PRIMARY KEY,
  plan_no VARCHAR(50) UNIQUE NOT NULL COMMENT 'æ‰“åŒ…å·¥åºè®¡åˆ’ç¼–å·',
  -- ... 60+ å­—æ®µ,ä¸ real_process_plans å®Œå…¨ä¸€è‡´
  customer_order_no VARCHAR(50) COMMENT 'å®¢æˆ·è®¢å•ç¼–å·',
  master_plan_product_code VARCHAR(50) COMMENT 'ä¸»è®¡åˆ’äº§å“ç¼–å·',
  master_plan_product_name VARCHAR(200) COMMENT 'ä¸»è®¡åˆ’äº§å“åç§°',
  order_promise_delivery_date DATE COMMENT 'è®¢å•æ‰¿è¯ºäº¤æœŸ',
  -- ... å…¶ä»–å­—æ®µ
) ENGINE=InnoDB COMMENT='æ‰“åŒ…å·¥åºè®¡åˆ’è¡¨';
```

#### ç»„è£…å·¥åºè®¡åˆ’è¡¨ (`assembly_process_plans`)
```sql
CREATE TABLE IF NOT EXISTS assembly_process_plans (
  -- ç»“æ„ä¸ packing_process_plans å®Œå…¨ä¸€è‡´
) ENGINE=InnoDB COMMENT='ç»„è£…å·¥åºè®¡åˆ’è¡¨';
```

**æ‰§è¡Œç»“æœ**:
```
âœ… æ‰“åŒ…å·¥åºè®¡åˆ’è¡¨åˆ›å»ºæˆåŠŸ
âœ… ç»„è£…å·¥åºè®¡åˆ’è¡¨åˆ›å»ºæˆåŠŸ
```

**Gitæäº¤**: `4c437a3`

---

## ğŸ” æŠ€æœ¯åˆ†æ

### å½“å‰æ•°æ®æµ

**å¤‡æ–™è®¡åˆ’** â†’ **çœŸå·¥åºè®¡åˆ’**

**å…³é”®ä»£ç ä½ç½®**:
- æ–‡ä»¶: `backend/services/materialPreparationPlanService.js`
- æ–¹æ³•: `pushToRealProcessPlan(data)` (ç¬¬929-1253è¡Œ)
- æ¨é€é€»è¾‘:
  ```javascript
  // ç¬¬1216è¡Œ
  const RealProcessPlanService = require('./realProcessPlanService');
  const createResult = await RealProcessPlanService.create(realProcessPlanData);
  ```

**æ•°æ®å­—æ®µ**:
- å‰ç«¯: `sourceProcess` (æ¥æºå·¥åº)
- åç«¯: `source_process`
- ä½ç½®: `/production-planning/material-preparation-new` é¡µé¢ç¬¬269-270è¡Œ

---

## â³ å¾…å®Œæˆçš„å·¥ä½œ

### 1. åˆ›å»ºæ‰“åŒ…å’Œç»„è£…å·¥åºè®¡åˆ’Service

éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–°Service:
- `backend/services/packingProcessPlanService.js`
- `backend/services/assemblyProcessPlanService.js`

**æ¨¡æ¿**: å¤åˆ¶ `realProcessPlanService.js` å¹¶ä¿®æ”¹è¡¨å

### 2. åˆ›å»ºè·¯ç”±API

éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–°è·¯ç”±:
- `backend/routes/packingProcessPlans.js`
- `backend/routes/assemblyProcessPlans.js`

### 3. ä¿®æ”¹æ•°æ®æ¨é€é€»è¾‘

**æ–‡ä»¶**: `backend/services/materialPreparationPlanService.js`  
**æ–¹æ³•**: `pushToRealProcessPlan(data)`

**ä¿®æ”¹æ–¹æ¡ˆ**:
```javascript
// ç¬¬1214-1216è¡Œ (å½“å‰ä»£ç )
const RealProcessPlanService = require('./realProcessPlanService');
const createResult = await RealProcessPlanService.create(realProcessPlanData);

// ä¿®æ”¹ä¸º:
let ProcessPlanService;
let targetTable;

if (data.sourceProcess === 'æ‰“åŒ…') {
  ProcessPlanService = require('./packingProcessPlanService');
  targetTable = 'packing_process_plans';
} else if (data.sourceProcess === 'ç»„è£…') {
  ProcessPlanService = require('./assemblyProcessPlanService');
  targetTable = 'assembly_process_plans';
} else {
  // å…¶ä»–å·¥åºä»æ¨é€åˆ°çœŸå·¥åºè®¡åˆ’
  ProcessPlanService = require('./realProcessPlanService');
  targetTable = 'real_process_plans';
}

const createResult = await ProcessPlanService.create(realProcessPlanData);
```

### 4. å‰ç«¯é¡µé¢é‡å‘½å

- `PackagingProcessPlanList.vue` â†’ `PackingProcessPlanList.vue`
- æ‰€æœ‰ "åŒ…è£…" æ–‡æœ¬ â†’ "æ‰“åŒ…"
- è·¯ç”±è·¯å¾„æ›´æ–°

### 5. èœå•é…ç½®æ›´æ–°

- `layout/index.vue` ç¬¬613-618è¡Œ
- "åŒ…è£…å·¥åºè®¡åˆ’" â†’ "æ‰“åŒ…å·¥åºè®¡åˆ’"

### 6. å‰ç«¯APIæ›´æ–°

éœ€è¦åˆ›å»º:
- `07-frontend/src/api/packingProcessPlan.js`
- `07-frontend/src/api/assemblyProcessPlan.js`

---

## ğŸ“Š å·¥ä½œé‡é¢„ä¼°

| ä»»åŠ¡ | é¢„ä¼°æ—¶é—´ | éš¾åº¦ |
|------|---------|------|
| åˆ›å»ºService (x2) | 30åˆ†é’Ÿ | ä¸­ |
| åˆ›å»ºè·¯ç”±API (x2) | 20åˆ†é’Ÿ | ä½ |
| ä¿®æ”¹æ¨é€é€»è¾‘ | 15åˆ†é’Ÿ | ä¸­ |
| é¡µé¢é‡å‘½å | 10åˆ†é’Ÿ | ä½ |
| èœå•æ›´æ–° | 5åˆ†é’Ÿ | ä½ |
| å‰ç«¯APIåˆ›å»º | 20åˆ†é’Ÿ | ä½ |
| æµ‹è¯•éªŒè¯ | 30åˆ†é’Ÿ | é«˜ |
| **æ€»è®¡** | **2.5å°æ—¶** | |

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### æ­¥éª¤1: åˆ›å»ºæ‰“åŒ…å·¥åºè®¡åˆ’Service
å¤åˆ¶å¹¶ä¿®æ”¹ `realProcessPlanService.js`,æ›¿æ¢æ‰€æœ‰:
- `real_process_plans` â†’ `packing_process_plans`
- `RealProcessPlan` â†’ `PackingProcessPlan`
- `RPP` â†’ `PKPP` (ç¼–å·å‰ç¼€)

### æ­¥éª¤2: åˆ›å»ºç»„è£…å·¥åºè®¡åˆ’Service
å¤åˆ¶å¹¶ä¿®æ”¹ `realProcessPlanService.js`,æ›¿æ¢æ‰€æœ‰:
- `real_process_plans` â†’ `assembly_process_plans`
- `RealProcessPlan` â†’ `AssemblyProcessPlan`
- `RPP` â†’ `ASPP` (ç¼–å·å‰ç¼€)

### æ­¥éª¤3: ä¿®æ”¹æ•°æ®æ¨é€è·¯ç”±é€»è¾‘
åœ¨ `materialPreparationPlanService.js` ä¸­æ·»åŠ æ¡ä»¶åˆ¤æ–­

### æ­¥éª¤4: å‰ç«¯é¡µé¢å’Œèœå•æ›´æ–°
æ‰¹é‡æ›¿æ¢ "åŒ…è£…" â†’ "æ‰“åŒ…"

### æ­¥éª¤5: å®Œæ•´æµ‹è¯•
- åˆ›å»ºå¤‡æ–™è®¡åˆ’ (æ¥æºå·¥åº=æ‰“åŒ…)
- éªŒè¯æ•°æ®æ¨é€åˆ° `packing_process_plans`
- åˆ›å»ºå¤‡æ–™è®¡åˆ’ (æ¥æºå·¥åº=ç»„è£…)
- éªŒè¯æ•°æ®æ¨é€åˆ° `assembly_process_plans`

---

## âš ï¸ é£é™©æç¤º

1. **å­—æ®µæ˜ å°„ä¸€è‡´æ€§**: ç¡®ä¿ä¸‰ä¸ªè¡¨çš„å­—æ®µå®Œå…¨ä¸€è‡´
2. **ç¼–å·è§„åˆ™å†²çª**: æ³¨æ„ä¸åŒå·¥åºçš„ç¼–å·å‰ç¼€è¦åŒºåˆ†
3. **è‡ªå¢è¡Œé€»è¾‘**: éœ€è¦åŒæ­¥å¤åˆ¶åˆ°æ–°Service
4. **æ’é˜Ÿé”æœºåˆ¶**: éœ€è¦åœ¨æ–°Serviceä¸­ä¹Ÿå®ç°
5. **å·²å ç”¨å·¥æ—¶æ¨é€**: éœ€è¦åŒæ­¥æ›´æ–°åˆ°å·¥åºèƒ½åŠ›è´Ÿè·è¡¨

---

## ğŸ“ å¾…ç¡®è®¤äº‹é¡¹

1. **çœŸå·¥åºè®¡åˆ’è¡¨ä¿ç•™å—?**
   - å»ºè®®ä¿ç•™,ç”¨äºå¤„ç†å…¶ä»–æœªåˆ†ç±»å·¥åº
   
2. **å†å²æ•°æ®è¿ç§»å—?**
   - å»ºè®®ä¸è¿ç§»,ä»æ–°æ•°æ®å¼€å§‹

3. **ç¼–å·è§„åˆ™ç¡®è®¤**:
   - æ‰“åŒ…å·¥åºè®¡åˆ’: `PKPP` + å¹´ä»½ + æ—¶é—´æˆ³
   - ç»„è£…å·¥åºè®¡åˆ’: `ASPP` + å¹´ä»½ + æ—¶é—´æˆ³
   - æ˜¯å¦éœ€è¦è°ƒæ•´?

---

## ğŸ“Œ å½“å‰çŠ¶æ€æ€»ç»“

**å·²å®Œæˆ**: 
- âœ… ä»£ç å¤‡ä»½
- âœ… æ•°æ®åº“è¡¨åˆ›å»º
- âœ… ä»£ç æ¨é€åˆ°è¿œç¨‹

**è¿›è¡Œä¸­**:
- â³ Serviceå±‚å¼€å‘
- â³ æ•°æ®è·¯ç”±é€»è¾‘ä¿®æ”¹

**å¾…å¼€å§‹**:
- â¸ å‰ç«¯é¡µé¢é‡å‘½å
- â¸ æµ‹è¯•éªŒè¯

**å®Œæˆåº¦**: 50%

---

**ä¸‹ä¸€æ­¥æ“ä½œ**: ç­‰å¾…ç”¨æˆ·ç¡®è®¤å,ç»§ç»­åˆ›å»ºServiceå’Œä¿®æ”¹æ¨é€é€»è¾‘ã€‚
