# ğŸš€ äººæœºæ–™æ³•ç¯æ’ç¨‹ç³»ç»Ÿ - å®Œæ•´ä½¿ç”¨æ‰‹å†Œ

## ç›®å½•

1. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
2. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
3. [å®Œæ•´ç¤ºä¾‹](#å®Œæ•´ç¤ºä¾‹)
4. [APIæ–‡æ¡£](#apiæ–‡æ¡£)
5. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       å‰ç«¯åº”ç”¨å±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æ’ç¨‹ç®¡ç† â”‚  â”‚ æ´¾å·¥ç®¡ç† â”‚  â”‚ æŠ¥å·¥ç®¡ç† â”‚  â”‚ èµ„æºç®¡ç† â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æœåŠ¡å±‚ (Services)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ resourceDataServiceâ”‚    â”‚ productionFlowServiceâ”‚         â”‚
â”‚  â”‚  (èµ„æºæ•°æ®æœåŠ¡)    â”‚    â”‚   (ç”Ÿäº§æµè½¬æœåŠ¡)   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ ¸å¿ƒå¼•æ“ (Engines)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚    FiniteCapacityScheduler (æœ‰é™äº§èƒ½æ’ç¨‹å¼•æ“)   â”‚         â”‚
â”‚  â”‚    - SchedulingConstraints (çº¦æŸç®¡ç†)           â”‚         â”‚
â”‚  â”‚    - SchedulingOptimizer (ä¼˜åŒ–å™¨)               â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    èµ„æºæ¨¡å‹ (Models)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Resourceâ”‚ â”‚ Worker  â”‚ â”‚Material â”‚ â”‚  Mold   â”‚          â”‚
â”‚  â”‚ (è®¾å¤‡)  â”‚ â”‚ (äººå‘˜)  â”‚ â”‚ (ç‰©æ–™)  â”‚ â”‚ (æ¨¡å…·)  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ Fixture â”‚ â”‚  Task   â”‚ â”‚ Process â”‚                      â”‚
â”‚  â”‚ (å¤¹å…·)  â”‚ â”‚ (ä»»åŠ¡)  â”‚ â”‚ (å·¥åº)  â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥æœåŠ¡

```javascript
import { FiniteCapacityScheduler } from '@/utils/schedulingEngine.js'
import resourceDataService from '@/services/resourceDataService.js'
import productionFlowService from '@/services/productionFlowService.js'
```

### ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹å¯ç”¨èµ„æº

```javascript
// è·å–èµ„æºæ¦‚è§ˆ
const summary = resourceDataService.getResourceSummary()
console.log('èµ„æºæ¦‚è§ˆ:', summary)

// è¾“å‡ºç¤ºä¾‹:
// {
//   equipment: { total: 5, available: 5, busy: 0, maintenance: 0 },
//   workers: { total: 5, available: 5, busy: 0 },
//   materials: { total: 4, lowStock: 0 },
//   molds: { total: 3, available: 3, needMaintenance: 0 },
//   fixtures: { total: 4, available: 4, totalQuantity: 53, availableQuantity: 46 }
// }
```

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºæ’ç¨‹ä»»åŠ¡

```javascript
// åˆ›å»ºæ’ç¨‹å¼•æ“
const scheduler = new FiniteCapacityScheduler({
  workingHours: { start: 8, end: 20 },  // å·¥ä½œæ—¶é—´
  workingDays: [1, 2, 3, 4, 5, 6],      // å·¥ä½œæ—¥
  holidays: ['2024-12-25', '2024-01-01'] // å‡æœŸ
})

// æ·»åŠ èµ„æºåˆ°æ’ç¨‹å¼•æ“
resourceDataService.getAllEquipment().forEach(eq => {
  scheduler.addResource(eq)
})

resourceDataService.getAllWorkers().forEach(worker => {
  scheduler.addWorker(worker)
})

resourceDataService.getAllMaterials().forEach(material => {
  scheduler.addMaterial(material)
})

resourceDataService.getAllMolds().forEach(mold => {
  scheduler.addMold(mold)
})

resourceDataService.getAllFixtures().forEach(fixture => {
  scheduler.addFixture(fixture)
})
```

---

## å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹1: åŸºç¡€æ’ç¨‹ï¼ˆè€ƒè™‘äººæœºæ–™æ³•ç¯ï¼‰

```javascript
<template>
  <div class="scheduling-example">
    <h1>ç”Ÿäº§æ’ç¨‹ - å®Œæ•´ç¤ºä¾‹</h1>
    
    <!-- èµ„æºçŠ¶æ€ -->
    <el-card>
      <template #header>èµ„æºçŠ¶æ€</template>
      <el-descriptions :column="3" border>
        <el-descriptions-item label="å¯ç”¨è®¾å¤‡">
          {{ summary.equipment.available }} / {{ summary.equipment.total }}
        </el-descriptions-item>
        <el-descriptions-item label="å¯ç”¨äººå‘˜">
          {{ summary.workers.available }} / {{ summary.workers.total }}
        </el-descriptions-item>
        <el-descriptions-item label="ä½åº“å­˜ç‰©æ–™">
          {{ summary.materials.lowStock }}
        </el-descriptions-item>
      </el-descriptions>
    </el-card>
    
    <!-- åˆ›å»ºä»»åŠ¡ -->
    <el-button type="primary" @click="createSchedulingTask">
      åˆ›å»ºæ’ç¨‹ä»»åŠ¡
    </el-button>
    
    <!-- æ’ç¨‹ç»“æœ -->
    <el-card v-if="scheduleResult">
      <template #header>æ’ç¨‹ç»“æœ</template>
      <el-table :data="scheduleResult.scheduledTasks">
        <el-table-column prop="taskId" label="ä»»åŠ¡ID" />
        <el-table-column prop="processName" label="å·¥åºåç§°" />
        <el-table-column prop="machineName" label="è®¾å¤‡" />
        <el-table-column prop="startTime" label="å¼€å§‹æ—¶é—´">
          <template #default="scope">
            {{ formatTime(scope.row.startTime) }}
          </template>
        </el-table-column>
        <el-table-column prop="endTime" label="ç»“æŸæ—¶é—´">
          <template #default="scope">
            {{ formatTime(scope.row.endTime) }}
          </template>
        </el-table-column>
        <el-table-column prop="duration" label="æ—¶é•¿(åˆ†é’Ÿ)" />
      </el-table>
      
      <!-- æ¨é€åˆ°æ´¾å·¥ -->
      <el-button 
        type="success" 
        @click="pushToDispatch"
        style="margin-top: 20px"
      >
        æ¨é€åˆ°æ´¾å·¥ç³»ç»Ÿ
      </el-button>
    </el-card>
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue'
import { ElMessage } from 'element-plus'
import { FiniteCapacityScheduler, SchedulingTask, ProcessStep } from '@/utils/schedulingEngine.js'
import resourceDataService from '@/services/resourceDataService.js'
import productionFlowService from '@/services/productionFlowService.js'

const scheduler = ref(null)
const scheduleResult = ref(null)

// èµ„æºæ¦‚è§ˆ
const summary = computed(() => {
  return resourceDataService.getResourceSummary()
})

onMounted(() => {
  initScheduler()
})

// åˆå§‹åŒ–æ’ç¨‹å¼•æ“
const initScheduler = () => {
  scheduler.value = new FiniteCapacityScheduler({
    workingHours: { start: 8, end: 20 },
    workingDays: [1, 2, 3, 4, 5, 6],
    shifts: [
      { id: 'day', name: 'ç™½ç­', start: 8, end: 20 },
      { id: 'night', name: 'å¤œç­', start: 20, end: 8 }
    ],
    
    // è®¾å¤‡çº¦æŸ
    maxCapacity: { 'EQ001': 2000, 'EQ002': 1 },
    setupTime: { 'EQ001': 30, 'EQ002': 45 },
    
    // äººå‘˜çº¦æŸ
    workerSkills: {
      'W001': ['æ³¨å¡‘', 'è®¾å¤‡ç»´æŠ¤'],
      'W002': ['CNCåŠ å·¥', 'ç¼–ç¨‹'],
      'W003': ['è£…é…', 'è´¨æ£€']
    },
    workerCapacity: {
      'W001': 1.2,
      'W002': 1.15,
      'W003': 1.0
    },
    
    // ç‰©æ–™çº¦æŸ
    materialInventory: {
      'M001': 5000,
      'M002': 200,
      'M003': 10000
    },
    materialLeadTime: {
      'M001': 3,
      'M002': 7,
      'M003': 2
    },
    safetyStock: {
      'M001': 500,
      'M002': 50,
      'M003': 2000
    },
    
    // æ¨¡å…·çº¦æŸ
    moldAvailability: {
      'MD001': true,
      'MD002': true,
      'MD003': true
    },
    moldLifecycle: {
      'MD001': { current: 1500, max: 10000 },
      'MD002': { current: 3200, max: 10000 }
    },
    
    // å¤¹å…·çº¦æŸ
    fixtureInventory: {
      'F001': 8,
      'F002': 8,
      'F003': 12,
      'F004': 18
    },
    fixtureCapacity: {
      'F001': 10,
      'F002': 8,
      'F003': 15,
      'F004': 20
    }
  })
  
  // æ·»åŠ èµ„æº
  resourceDataService.getAllEquipment().forEach(eq => {
    scheduler.value.addResource(eq)
  })
  
  resourceDataService.getAllWorkers().forEach(worker => {
    scheduler.value.addWorker(worker)
  })
  
  resourceDataService.getAllMaterials().forEach(material => {
    scheduler.value.addMaterial(material)
  })
  
  resourceDataService.getAllMolds().forEach(mold => {
    scheduler.value.addMold(mold)
  })
  
  resourceDataService.getAllFixtures().forEach(fixture => {
    scheduler.value.addFixture(fixture)
  })
}

// åˆ›å»ºæ’ç¨‹ä»»åŠ¡
const createSchedulingTask = async () => {
  // å®šä¹‰ä»»åŠ¡
  const task = new SchedulingTask({
    id: 'TASK-001',
    orderCode: 'ORD-20240115-001',
    productCode: 'PROD-A',
    productName: 'å¡‘æ–™å¤–å£³A',
    quantity: 1000,
    dueDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // 7å¤©å
    priority: 1
  })
  
  // å®šä¹‰å·¥åºï¼ˆå®Œæ•´çš„äººæœºæ–™æ³•ç¯è¦æ±‚ï¼‰
  const processes = [
    new ProcessStep({
      id: 'PROC-001',
      taskId: 'TASK-001',
      processName: 'åŸæ–™å‡†å¤‡',
      processCode: 'P01',
      sequence: 1,
      standardTime: 0.5,  // 0.5åˆ†é’Ÿ/ä»¶
      setupTime: 10,
      
      // äººå‘˜è¦æ±‚
      requiredWorkers: 1,
      requiredSkills: ['ç‰©æ–™ç®¡ç†'],
      
      // è®¾å¤‡è¦æ±‚
      requiredMachine: ['EQ003'],  // ä¸éœ€è¦ç‰¹å®šè®¾å¤‡
      
      // ç‰©æ–™è¦æ±‚
      requiredMaterials: [
        { id: 'M001', name: 'ABSå¡‘æ–™ç²’å­' }
      ],
      materialConsumption: {
        'M001': 0.05  // æ¯ä»¶æ¶ˆè€—0.05kg
      },
      
      // è´¨é‡è¦æ±‚
      qualityLevel: 'normal',
      inspectionRequired: false
    }),
    
    new ProcessStep({
      id: 'PROC-002',
      taskId: 'TASK-001',
      processName: 'æ³¨å¡‘æˆå‹',
      processCode: 'P02',
      sequence: 2,
      standardTime: 2.0,  // 2åˆ†é’Ÿ/ä»¶ï¼ˆè€ƒè™‘4æ¨¡ç©´ï¼‰
      setupTime: 30,      // æ¢æ¨¡æ—¶é—´30åˆ†é’Ÿ
      
      // äººå‘˜è¦æ±‚
      requiredWorkers: 1,
      requiredSkills: ['æ³¨å¡‘'],
      
      // è®¾å¤‡è¦æ±‚
      requiredMachine: ['EQ001'],  // æ³¨å¡‘æœº
      machineEfficiency: 0.95,
      
      // æ¨¡å…·è¦æ±‚
      requiredMold: 'MD001',       // æ³¨å¡‘æ¨¡å…·Aï¼ˆ4æ¨¡ç©´ï¼‰
      moldCycles: 250,             // 1000ä»¶/4æ¨¡ç©´ = 250æ¬¡
      
      // å¤¹å…·è¦æ±‚
      requiredFixture: 'F001',     // æ³¨å¡‘å¤¹å…·A
      fixtureQuantity: 2,
      
      // å·¥è‰ºçº¦æŸ
      predecessors: ['PROC-001'],  // å¿…é¡»åœ¨åŸæ–™å‡†å¤‡åè¿›è¡Œ
      
      // è´¨é‡è¦æ±‚
      qualityLevel: 'high',
      inspectionRequired: true
    }),
    
    new ProcessStep({
      id: 'PROC-003',
      taskId: 'TASK-001',
      processName: 'è´¨é‡æ£€éªŒ',
      processCode: 'P03',
      sequence: 3,
      standardTime: 0.2,  // 0.2åˆ†é’Ÿ/ä»¶
      setupTime: 5,
      
      // äººå‘˜è¦æ±‚
      requiredWorkers: 1,
      requiredSkills: ['è´¨æ£€'],
      
      // è®¾å¤‡è¦æ±‚
      requiredMachine: ['EQ005'],  // ä¸‰åæ ‡æµ‹é‡æœº
      
      // å·¥è‰ºçº¦æŸ
      predecessors: ['PROC-002'],
      
      // è´¨é‡è¦æ±‚
      qualityLevel: 'high',
      inspectionRequired: true
    }),
    
    new ProcessStep({
      id: 'PROC-004',
      taskId: 'TASK-001',
      processName: 'åŒ…è£…å…¥åº“',
      processCode: 'P04',
      sequence: 4,
      standardTime: 0.3,  // 0.3åˆ†é’Ÿ/ä»¶
      setupTime: 10,
      
      // äººå‘˜è¦æ±‚
      requiredWorkers: 2,
      requiredSkills: ['åŒ…è£…'],
      
      // ç‰©æ–™è¦æ±‚
      requiredMaterials: [
        { id: 'M004', name: 'åŒ…è£…ç›’' }
      ],
      materialConsumption: {
        'M004': 1  // æ¯ä»¶1ä¸ªåŒ…è£…ç›’
      },
      
      // å·¥è‰ºçº¦æŸ
      predecessors: ['PROC-003'],
      
      // è´¨é‡è¦æ±‚
      qualityLevel: 'normal',
      inspectionRequired: false
    })
  ]
  
  // æ£€æŸ¥èµ„æºæ˜¯å¦å……è¶³
  const checkResult = resourceDataService.checkSchedulingResources({
    equipment: [{ id: 'EQ001' }, { id: 'EQ005' }],
    workers: [
      { skill: 'æ³¨å¡‘', count: 1 },
      { skill: 'è´¨æ£€', count: 1 },
      { skill: 'åŒ…è£…', count: 2 }
    ],
    materials: [
      { id: 'M001', quantity: 50 },  // 1000ä»¶ * 0.05kg
      { id: 'M004', quantity: 1000 }
    ],
    molds: [{ id: 'MD001' }],
    fixtures: [{ id: 'F001', quantity: 2 }]
  })
  
  if (!checkResult.success) {
    ElMessage.error(`èµ„æºä¸è¶³:\n${checkResult.issues.join('\n')}`)
    return
  }
  
  // æ·»åŠ ä»»åŠ¡å’Œå·¥åºåˆ°æ’ç¨‹å¼•æ“
  scheduler.value.addTask(task)
  processes.forEach(proc => {
    scheduler.value.addProcess(proc)
  })
  
  // æ‰§è¡Œæ’ç¨‹
  ElMessage.loading('æ­£åœ¨æ’ç¨‹ï¼Œè¯·ç¨å€™...')
  try {
    const result = await scheduler.value.schedule('priority')
    scheduleResult.value = result
    
    if (result.success) {
      ElMessage.success(`æ’ç¨‹æˆåŠŸï¼å…±æ’ç¨‹${result.scheduledTasks.length}ä¸ªå·¥åº`)
      
      // æ˜¾ç¤ºæ’ç¨‹æŒ‡æ ‡
      console.log('æ’ç¨‹æŒ‡æ ‡:', result.metrics)
      console.log('èµ„æºåˆ©ç”¨ç‡:', result.resourceUtilization)
      
      if (result.warnings.length > 0) {
        ElMessage.warning(`è­¦å‘Š: ${result.warnings.join('; ')}`)
      }
    } else {
      ElMessage.error('æ’ç¨‹å¤±è´¥')
    }
  } catch (error) {
    ElMessage.error(`æ’ç¨‹å‡ºé”™: ${error.message}`)
  }
}

// æ¨é€åˆ°æ´¾å·¥ç³»ç»Ÿ
const pushToDispatch = async () => {
  try {
    const result = await productionFlowService.pushScheduleToDispatch(scheduleResult.value)
    if (result.success) {
      ElMessage.success(`æˆåŠŸæ¨é€${result.count}ä¸ªæ´¾å·¥ä»»åŠ¡`)
    }
  } catch (error) {
    ElMessage.error(`æ¨é€å¤±è´¥: ${error.message}`)
  }
}

// æ ¼å¼åŒ–æ—¶é—´
const formatTime = (timestamp) => {
  const date = new Date(timestamp)
  const month = String(date.getMonth() + 1).padStart(2, '0')
  const day = String(date.getDate()).padStart(2, '0')
  const hours = String(date.getHours()).padStart(2, '0')
  const minutes = String(date.getMinutes()).padStart(2, '0')
  return `${month}-${day} ${hours}:${minutes}`
}
</script>
```

---

### ç¤ºä¾‹2: èµ„æºå†²çªå¤„ç†

```javascript
// åœºæ™¯ï¼šå¤šä¸ªä»»åŠ¡ç«äº‰åŒä¸€èµ„æº

const task1 = new SchedulingTask({
  id: 'TASK-001',
  priority: 1,  // é«˜ä¼˜å…ˆçº§
  quantity: 500
})

const task2 = new SchedulingTask({
  id: 'TASK-002',
  priority: 2,  // ä¸­ä¼˜å…ˆçº§
  quantity: 1000
})

const task3 = new SchedulingTask({
  id: 'TASK-003',
  priority: 3,  // ä½ä¼˜å…ˆçº§
  quantity: 800
})

// ä¸‰ä¸ªä»»åŠ¡éƒ½éœ€è¦åŒä¸€å°æ³¨å¡‘æœºEQ001
// æ’ç¨‹å¼•æ“ä¼šæŒ‰ä¼˜å…ˆçº§è‡ªåŠ¨åˆ†é…æ—¶é—´ï¼Œé¿å…å†²çª

scheduler.addTask(task1)
scheduler.addTask(task2)
scheduler.addTask(task3)

const result = await scheduler.schedule('priority')

// ç»“æœï¼šTASK-001 å…ˆæ’ç¨‹ï¼ŒTASK-002 æ¬¡ä¹‹ï¼ŒTASK-003 æœ€å
// æ²¡æœ‰æ—¶é—´å†²çªï¼Œèµ„æºæœ‰åºä½¿ç”¨
```

---

### ç¤ºä¾‹3: ç‰©æ–™çŸ­ç¼ºé¢„è­¦

```javascript
// æ£€æŸ¥ç‰©æ–™åº“å­˜
const lowStockMaterials = resourceDataService.getLowStockMaterials()

if (lowStockMaterials.length > 0) {
  console.log('âš ï¸ ä»¥ä¸‹ç‰©æ–™åº“å­˜ä¸è¶³ï¼š')
  lowStockMaterials.forEach(material => {
    console.log(`- ${material.name}: å½“å‰${material.currentStock}, å®‰å…¨åº“å­˜${material.safetyStock}`)
    const shortage = material.getShortage(material.safetyStock)
    console.log(`  ç¼ºè´§é‡: ${shortage}, é‡‡è´­å‘¨æœŸ: ${material.leadTime}å¤©`)
  })
  
  ElMessage.warning(`${lowStockMaterials.length}ç§ç‰©æ–™åº“å­˜ä¸è¶³ï¼Œè¯·åŠæ—¶é‡‡è´­`)
}
```

---

### ç¤ºä¾‹4: æ¨¡å…·å¯¿å‘½ç®¡ç†

```javascript
// æ£€æŸ¥æ¨¡å…·çŠ¶æ€
const molds = resourceDataService.getAllMolds()

molds.forEach(mold => {
  // æ£€æŸ¥æ˜¯å¦éœ€è¦ä¿å…»
  if (mold.needsMaintenance()) {
    console.warn(`âš ï¸ æ¨¡å…·${mold.name}éœ€è¦ä¿å…»`)
    ElMessage.warning(`æ¨¡å…·${mold.name}å·²ä½¿ç”¨${mold.lifecycle - mold.lastMaintenanceCount}æ¬¡ï¼Œéœ€è¦ä¿å…»`)
  }
  
  // æ£€æŸ¥å‰©ä½™å¯¿å‘½
  const remainingLife = mold.getRemainingLife()
  if (parseFloat(remainingLife) < 20) {
    console.error(`âŒ æ¨¡å…·${mold.name}å¯¿å‘½å³å°†è€—å°½`)
    ElMessage.error(`æ¨¡å…·${mold.name}å‰©ä½™å¯¿å‘½ä»…${remainingLife}%ï¼Œè¯·å‡†å¤‡æ›´æ¢`)
  } else if (parseFloat(remainingLife) < 50) {
    console.warn(`âš ï¸ æ¨¡å…·${mold.name}å¯¿å‘½è¿‡åŠ`)
  }
})
```

---

### ç¤ºä¾‹5: å¤¹å…·æ•°é‡ç®¡ç†

```javascript
// ä½¿ç”¨å¤¹å…·
const fixtureId = 'F001'
const requiredQuantity = 3

// æ£€æŸ¥å¯ç”¨æ€§
if (resourceDataService.checkFixtureAvailability(fixtureId, requiredQuantity)) {
  // å ç”¨å¤¹å…·
  const success = resourceDataService.occupyFixture(fixtureId, requiredQuantity)
  if (success) {
    console.log(`æˆåŠŸå ç”¨${requiredQuantity}ä¸ªå¤¹å…·`)
    
    // å·¥ä½œå®Œæˆåé‡Šæ”¾
    setTimeout(() => {
      resourceDataService.releaseFixture(fixtureId, requiredQuantity)
      console.log(`å·²é‡Šæ”¾${requiredQuantity}ä¸ªå¤¹å…·`)
    }, 60000)  // 1åˆ†é’Ÿåé‡Šæ”¾
  }
} else {
  ElMessage.error('å¤¹å…·æ•°é‡ä¸è¶³')
}
```

---

## APIæ–‡æ¡£

### ResourceDataService API

#### è®¾å¤‡èµ„æº

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `getAllEquipment()` | - | Array<Resource> | è·å–æ‰€æœ‰è®¾å¤‡ |
| `getAvailableEquipment()` | - | Array<Resource> | è·å–å¯ç”¨è®¾å¤‡ |
| `getEquipmentByType(type)` | type: String | Array<Resource> | æŒ‰ç±»å‹è·å–è®¾å¤‡ |
| `getEquipmentById(id)` | id: String | Resource | æŒ‰IDè·å–è®¾å¤‡ |
| `addEquipment(data)` | data: Object | Resource | æ·»åŠ è®¾å¤‡ |
| `updateEquipmentStatus(id, status)` | id: String, status: String | Boolean | æ›´æ–°è®¾å¤‡çŠ¶æ€ |

#### äººå‘˜èµ„æº

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `getAllWorkers()` | - | Array<WorkerResource> | è·å–æ‰€æœ‰äººå‘˜ |
| `getAvailableWorkers()` | - | Array<WorkerResource> | è·å–å¯ç”¨äººå‘˜ |
| `getWorkersBySkill(skill)` | skill: String | Array<WorkerResource> | æŒ‰æŠ€èƒ½è·å–äººå‘˜ |
| `getWorkersByShift(shift)` | shift: String | Array<WorkerResource> | æŒ‰ç­æ¬¡è·å–äººå‘˜ |
| `addWorker(data)` | data: Object | WorkerResource | æ·»åŠ äººå‘˜ |

#### ç‰©æ–™èµ„æº

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `getAllMaterials()` | - | Array<MaterialResource> | è·å–æ‰€æœ‰ç‰©æ–™ |
| `getMaterialById(id)` | id: String | MaterialResource | æŒ‰IDè·å–ç‰©æ–™ |
| `checkMaterialStock(id, quantity)` | id: String, quantity: Number | Boolean | æ£€æŸ¥åº“å­˜ |
| `getLowStockMaterials()` | - | Array<MaterialResource> | è·å–ä½åº“å­˜ç‰©æ–™ |
| `consumeMaterial(id, quantity)` | id: String, quantity: Number | Boolean | æ¶ˆè€—ç‰©æ–™ |
| `addMaterial(data)` | data: Object | MaterialResource | æ·»åŠ ç‰©æ–™ |

#### æ¨¡å…·èµ„æº

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `getAllMolds()` | - | Array<MoldResource> | è·å–æ‰€æœ‰æ¨¡å…· |
| `getAvailableMolds()` | - | Array<MoldResource> | è·å–å¯ç”¨æ¨¡å…· |
| `getMoldsByType(type)` | type: String | Array<MoldResource> | æŒ‰ç±»å‹è·å–æ¨¡å…· |
| `getMoldById(id)` | id: String | MoldResource | æŒ‰IDè·å–æ¨¡å…· |
| `checkMoldMaintenance(id)` | id: String | Boolean | æ£€æŸ¥æ˜¯å¦éœ€è¦ç»´æŠ¤ |
| `addMold(data)` | data: Object | MoldResource | æ·»åŠ æ¨¡å…· |

#### å¤¹å…·èµ„æº

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `getAllFixtures()` | - | Array<FixtureResource> | è·å–æ‰€æœ‰å¤¹å…· |
| `getAvailableFixtures()` | - | Array<FixtureResource> | è·å–å¯ç”¨å¤¹å…· |
| `getFixturesByType(type)` | type: String | Array<FixtureResource> | æŒ‰ç±»å‹è·å–å¤¹å…· |
| `checkFixtureAvailability(id, quantity)` | id: String, quantity: Number | Boolean | æ£€æŸ¥å¯ç”¨æ€§ |
| `occupyFixture(id, quantity)` | id: String, quantity: Number | Boolean | å ç”¨å¤¹å…· |
| `releaseFixture(id, quantity)` | id: String, quantity: Number | Boolean | é‡Šæ”¾å¤¹å…· |
| `addFixture(data)` | data: Object | FixtureResource | æ·»åŠ å¤¹å…· |

#### ç»¼åˆæŸ¥è¯¢

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `getResourceSummary()` | - | Object | è·å–èµ„æºæ¦‚è§ˆ |
| `checkSchedulingResources(requirements)` | requirements: Object | Object | æ£€æŸ¥æ’ç¨‹èµ„æº |

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•å¤„ç†è®¾å¤‡ç»´æŠ¤æœŸé—´çš„æ’ç¨‹ï¼Ÿ

**ç­”:** åœ¨åˆ›å»ºResourceæ—¶è®¾ç½®`nextMaintenanceDate`å’Œ`maintenanceDuration`:

```javascript
new Resource({
  id: 'EQ001',
  nextMaintenanceDate: '2024-02-01',  // ä¸‹æ¬¡ç»´æŠ¤æ—¥æœŸ
  maintenanceDuration: 4,              // ç»´æŠ¤æ—¶é•¿ï¼ˆå°æ—¶ï¼‰
  // ... å…¶ä»–å±æ€§
})
```

æ’ç¨‹å¼•æ“ä¼šè‡ªåŠ¨é¿å¼€ç»´æŠ¤æ—¶é—´ã€‚

### Q2: å¦‚ä½•å®ç°å¤šç­æ¬¡æ’ç¨‹ï¼Ÿ

**ç­”:** åœ¨SchedulingConstraintsä¸­å®šä¹‰ç­æ¬¡:

```javascript
const scheduler = new FiniteCapacityScheduler({
  shifts: [
    { id: 'day', name: 'ç™½ç­', start: 8, end: 20 },
    { id: 'night', name: 'å¤œç­', start: 20, end: 8 }
  ]
})
```

ç„¶åä¸ºå·¥äººåˆ†é…ç­æ¬¡:

```javascript
new WorkerResource({
  id: 'W001',
  shift: 'day',  // ç™½ç­
  // ...
})
```

### Q3: å¦‚ä½•ä¼˜å…ˆä¿è¯ç´§æ€¥è®¢å•ï¼Ÿ

**ç­”:** è®¾ç½®æ›´é«˜çš„ä»»åŠ¡ä¼˜å…ˆçº§:

```javascript
const urgentTask = new SchedulingTask({
  id: 'URGENT-001',
  priority: 1,  // æœ€é«˜ä¼˜å…ˆçº§
  // ...
})

const normalTask = new SchedulingTask({
  id: 'NORMAL-001',
  priority: 5,  // æ™®é€šä¼˜å…ˆçº§
  // ...
})
```

ä½¿ç”¨`priority`ç®—æ³•æ’ç¨‹ä¼šä¼˜å…ˆå¤„ç†ç´§æ€¥è®¢å•ã€‚

### Q4: ç‰©æ–™åº“å­˜ä¸è¶³æ—¶æ€ä¹ˆåŠï¼Ÿ

**ç­”:** ä½¿ç”¨`checkSchedulingResources`æå‰æ£€æŸ¥:

```javascript
const checkResult = resourceDataService.checkSchedulingResources({
  materials: [
    { id: 'M001', quantity: 5000 }
  ]
})

if (!checkResult.success) {
  console.error('èµ„æºä¸è¶³:', checkResult.issues)
  // æç¤ºé‡‡è´­æˆ–è°ƒæ•´æ’ç¨‹
}
```

### Q5: å¦‚ä½•é¿å…æ¨¡å…·è¿‡åº¦ä½¿ç”¨ï¼Ÿ

**ç­”:** æ¨¡å…·èµ„æºä¼šè‡ªåŠ¨è·Ÿè¸ªä½¿ç”¨æ¬¡æ•°:

```javascript
// ä½¿ç”¨æ¨¡å…·æ—¶è‡ªåŠ¨è®¡æ•°
mold.use(250)  // ä½¿ç”¨250æ¬¡

// æ£€æŸ¥å¯¿å‘½
if (mold.getRemainingLife() < 20) {
  console.warn('æ¨¡å…·å¯¿å‘½ä¸è¶³20%ï¼Œè¯·å‡†å¤‡æ›´æ¢')
}

// æ£€æŸ¥ä¿å…»
if (mold.needsMaintenance()) {
  console.warn('æ¨¡å…·éœ€è¦ä¿å…»')
}
```

### Q6: å¤¹å…·æ•°é‡å¦‚ä½•å®æ—¶ç®¡ç†ï¼Ÿ

**ç­”:** ä½¿ç”¨å ç”¨å’Œé‡Šæ”¾æœºåˆ¶:

```javascript
// å ç”¨
resourceDataService.occupyFixture('F001', 3)

// ä½¿ç”¨å®Œåé‡Šæ”¾
resourceDataService.releaseFixture('F001', 3)
```

ç³»ç»Ÿä¼šè‡ªåŠ¨è¿½è¸ªå¯ç”¨æ•°é‡ã€‚

### Q7: å¦‚ä½•å®ç°è´Ÿè½½å‡è¡¡ï¼Ÿ

**ç­”:** ä½¿ç”¨SchedulingOptimizer:

```javascript
import { SchedulingOptimizer } from '@/utils/schedulingEngine.js'

const optimizer = new SchedulingOptimizer(scheduler)
const result = await optimizer.balanceLoad()

console.log(`æˆåŠŸè½¬ç§»${result.movedCount}ä¸ªä»»åŠ¡ï¼Œå®ç°è´Ÿè½½å‡è¡¡`)
```

### Q8: æ’ç¨‹ç»“æœå¦‚ä½•æ¨é€åˆ°æ´¾å·¥ç³»ç»Ÿï¼Ÿ

**ç­”:** ä½¿ç”¨productionFlowService:

```javascript
import productionFlowService from '@/services/productionFlowService.js'

const result = await scheduler.schedule('priority')
await productionFlowService.pushScheduleToDispatch(result)
```

---

## æ€»ç»“

### ç³»ç»Ÿä¼˜åŠ¿

âœ… **å®Œæ•´çš„äººæœºæ–™æ³•ç¯æ¨¡å¤¹çº¦æŸ**  
âœ… **æ™ºèƒ½èµ„æºåˆ†é…ç®—æ³•**  
âœ… **å®æ—¶å†²çªæ£€æµ‹å’Œé¢„è­¦**  
âœ… **è‡ªåŠ¨è´Ÿè½½å‡è¡¡ä¼˜åŒ–**  
âœ… **å®Œæ•´çš„ç”Ÿäº§æµè½¬é“¾è·¯**  
âœ… **æ˜“ç”¨çš„APIæ¥å£**  

### ä¸‹ä¸€æ­¥

1. æ ¹æ®å®é™…ä¸šåŠ¡è°ƒæ•´çº¦æŸå‚æ•°
2. é›†æˆåˆ°ç°æœ‰é¡µé¢ï¼ˆ19ä¸ªèµ„æºç®¡ç†é¡µé¢ï¼‰
3. è¿æ¥çœŸå®æ•°æ®åº“
4. æ·»åŠ å®æ—¶ç›‘æ§å’ŒæŠ¥è¡¨
5. ä¼˜åŒ–ç®—æ³•æ€§èƒ½

---

**ğŸ‰ æ­å–œï¼æ‚¨å·²ç»æŒæ¡äº†å®Œæ•´çš„äººæœºæ–™æ³•ç¯æ’ç¨‹ç³»ç»Ÿï¼**
